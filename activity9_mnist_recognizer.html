<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì†ê¸€ì”¨ ì¸ì‹ í…ŒìŠ¤íŠ¸</title>

    <!-- ğŸ” SEO (ê²€ìƒ‰ì—”ì§„ ìµœì í™”) -->
    <meta name="description" content="ì†ê¸€ì”¨ ìˆ«ìë¥¼ ì§ì ‘ ê·¸ë ¤ ì¸ê³µì§€ëŠ¥ ëª¨ë¸ì´ ì¸ì‹í•˜ë„ë¡ ì²´í—˜í•˜ëŠ” í™œë™ì…ë‹ˆë‹¤. AIê°€ ì´ë¯¸ì§€ë¥¼ ì–´ë–»ê²Œ í•™ìŠµí•˜ê³  ì˜ˆì¸¡í•˜ëŠ”ì§€ íƒêµ¬í•´ ë³´ì„¸ìš”.">
    <meta name="keywords" content="ì†ê¸€ì”¨ ì¸ì‹, MNIST, ì¸ê³µì§€ëŠ¥ ëª¨ë¸, ë¨¸ì‹ ëŸ¬ë‹, ë”¥ëŸ¬ë‹, AI ì²´í—˜, êµìœ¡ìš© í™œë™, ìˆ«ì ì¸ì‹, ìˆ˜í•™ êµìœ¡">
    <meta name="author" content="í™©ì„±í˜„">
    <meta name="google-site-verification" content="s7dTY3TNe-PjxGrl--MTPXDXJcgD2V7_6MDZ4SoEDP8" />
    <meta name="naver-site-verification" content="c020330e12eea0ae1a60707941a61b11590df69" />

    <!-- ğŸ“± SNS ê³µìœ  (Open Graph) -->
    <meta property="og:title" content="ì†ê¸€ì”¨ ì¸ì‹ ì²´í—˜ - ì¸ê³µì§€ëŠ¥ ìˆ˜í•™ í™œë™">
    <meta property="og:description" content="ì‚¬ìš©ìê°€ ê·¸ë¦° ì†ê¸€ì”¨ ìˆ«ìë¥¼ ì¸ê³µì§€ëŠ¥ì´ ì¸ì‹í•˜ëŠ” ê³¼ì •ì„ ì§ì ‘ ì²´í—˜í•˜ê³  AIì˜ ì‘ë™ ë°©ì‹ì„ íƒêµ¬í•˜ëŠ” í™œë™ í˜ì´ì§€ì…ë‹ˆë‹¤.">
    <meta property="og:image" content="https://tjdgus1121.github.io/thumbnail.png">
    <meta property="og:url" content="https://tjdgus1121.github.io/activity9_mnist_recognizer.html">
    <meta property="og:type" content="website">

    <!-- ğŸ” SEO (ì¶”ê°€ ë©”íƒ€ë°ì´í„°) -->
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://tjdgus1121.github.io/activity9_mnist_recognizer.html">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
        integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Do+Hyeon&family=Jua&family=Nanum+Pen+Script&family=Noto+Sans+KR:wght@100..900&family=Orbitron:wght@400..900&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Gamja+Flower&display=swap" rel="stylesheet">
    <link rel="shortcut icon" href="./favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="stylefooter.css">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ì†ê¸€ì”¨ ì¸ì‹ ì²´í—˜">
    <meta name="twitter:description" content="ì‚¬ìš©ì ì†ê¸€ì”¨ ìˆ«ìë¥¼ ì¸ê³µì§€ëŠ¥ì´ ì¸ì‹í•˜ëŠ” êµìœ¡ìš© ì²´í—˜ í™œë™.">
    <meta name="twitter:image" content="https://tjdgus1121.github.io/thumbnail.png">

    <meta name="subject" content="AI ìˆ˜í•™ êµìœ¡ ì²´í—˜">
    <meta name="theme-color" content="#ff9a9e">
    <meta name="copyright" content="í™©ì„±í˜„">
    <meta name="reply-to" content="tjdgus1121@naver.com">
    <meta name="url" content="https://tjdgus1121.github.io/activity9_mnist_recognizer.html">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tensorflow/4.13.0/tf.min.js"></script>
    <style>
        /* ì „ì—­ ìŠ¤íƒ€ì¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%);
            min-height: 100vh;
            padding: 20px;
        }

        /* ë©”ì¸ ë ˆì´ì•„ì›ƒ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
        .main-layout-container {
            display: flex;
            justify-content: center;
            /* ê°€ë¡œ ì¤‘ì•™ ì •ë ¬ */
            align-items: flex-start;
            /* ì„¸ë¡œ ìƒë‹¨ ì •ë ¬ (ì½˜í…ì¸  ë”°ë¼ ë‚´ë ¤ì˜¤ë„ë¡) */
            gap: 40px;
            /* ë©”ì¸ ì•±ê³¼ ì´ë¯¸ì§€ ì˜ì—­ ì‚¬ì´ ê°„ê²© */
            padding: 20px;
            /* ì „ì²´ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ì—¬ë°± */
            width: 100%;
            /* ë¶€ëª¨ ë„ˆë¹„ì— ë§ì¶¤ */
            max-width: 1200px;
            /* ì „ì²´ ë ˆì´ì•„ì›ƒ ìµœëŒ€ ë„ˆë¹„ ì œí•œ */
            margin: 0 auto;
            /* ì»¨í…Œì´ë„ˆ ìì²´ë¥¼ ì¤‘ì•™ì— */
            flex-wrap: wrap;
        }

        /* BEM ìŠ¤íƒ€ì¼ ì ìš© */
        .mnist-app {
            background: rgba(255, 255, 255, 0.95);
            -webkit-backdrop-filter: blur(10px);
            /* Safari ì§€ì› */
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            width: 100%;
            text-align: center;
            display: flex;
            /* ë‚´ë¶€ ìš”ì†Œ ì •ë ¬ì„ ìœ„í•´ flexbox ì‚¬ìš© */
            flex-direction: column;
            align-items: center;
        }

        .mnist-app__title {
            color: #333;
            margin-bottom: 30px;
            font-size: 3rem;
            letter-spacing: 2px;
            font-family:"Do Hyeon";
            font-weight: 700;
            background: linear-gradient(45deg, #66b5ea, rgb(26, 10, 43), #ac87aa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: rgba(255, 255, 255, 0);
            background-clip: text;
        }
        .mnist-app__title span{
            -webkit-text-fill-color: white;
        }

        .mnist-app__instructions {
            background: rgba(102, 126, 234, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            border-left: 4px solid #667eea;
            text-align: left;
            /* ì§€ì¹¨ì€ ì™¼ìª½ ì •ë ¬ */
            width: 100%;
            /* ë¶€ëª¨ ë„ˆë¹„ì— ë§ì¶¤ */
        }

        .mnist-app__instructions h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .mnist-app__instructions p {
            color: #666;
            line-height: 1.6;
        }

        .mnist-app__status {
            margin: 10px 0;
            padding: 10px;
            border-radius: 10px;
            font-weight: 500;
            width: 100%;
            /* ë¶€ëª¨ ë„ˆë¹„ì— ë§ì¶¤1 */
        }

        .mnist-app__status--loading {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }

        .mnist-app__status--ready {
            background: rgba(34, 197, 94, 0.1);
            color: #16a34a;
        }

        /* ë¡œë”© ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
        .mnist-app__loading-container {
            margin: 20px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: 100%;
            /* ë¶€ëª¨ ë„ˆë¹„ì— ë§ì¶¤ */
            max-width: 500px;
            /* ì»¨í…Œì´ë„ˆ ë„ˆë¹„ ì œí•œ */
        }

        .mnist-app__progress-text {
            text-align: center;
            font-size: 1.1rem;
            color: #333;
            margin: 5px 0;
        }

        .mnist-app__progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e6ed;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
            position: relative;
        }

        .mnist-app__progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 10px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .mnist-app__loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 10px auto;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .mnist-app__loading-steps {
            margin-top: 15px;
            padding: 10px;
            background: rgba(102, 126, 234, 0.05);
            border-radius: 8px;
            text-align: left;
            /* ë‹¨ê³„ ëª©ë¡ ì™¼ìª½ ì •ë ¬ */
        }

        .mnist-app__step {
            margin: 5px 0;
            padding: 5px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .mnist-app__step--active {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            font-weight: 600;
        }

        .mnist-app__step--completed {
            background: rgba(34, 197, 94, 0.1);
            color: #16a34a;
        }

        .mnist-app__drawing-area {
            display: flex;
            flex-direction: row;
            gap: 20px;
            align-items: flex-start;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 30px;
            width: 100%;
        }

        .drawing-and-debug-wrapper {
            display: flex;
            gap: 30px;
            align-items: flex-start;
            flex-wrap: wrap;
            justify-content: center;
            flex-grow: 1;
        }

        .mnist-app__canvas-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .mnist-app__canvas--drawing {
            border: 3px solid #667eea;
            border-radius: 15px;
            cursor: crosshair;
            background: white;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s ease;
        }

        .mnist-app__canvas--drawing:hover {
            transform: scale(1.02);
        }

        .mnist-app__controls {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .mnist-app__button {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .mnist-app__button--clear {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
        }

        .mnist-app__button--clear:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
        }

        .mnist-app__button--predict {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .mnist-app__button--predict:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .mnist-app__button--predict:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .mnist-app__results {
            background: linear-gradient(135deg, #f8f9ff, #e6f3ff);
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.05);
            width: 100%;
            /* ë¶€ëª¨ ë„ˆë¹„ì— ë§ì¶¤ */
        }

        .mnist-app__prediction-result {
            font-size: 1.8rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
        }

        .mnist-app__confidence-bars {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            max-width: 500px;
            margin: 0 auto;
        }

        .mnist-app__confidence-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .mnist-app__digit-label {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .mnist-app__confidence-bar {
            width: 40px;
            height: 120px;
            background: #e0e6ed;
            border-radius: 20px;
            position: relative;
            overflow: hidden;
        }

        .mnist-app__confidence-fill {
            position: absolute;
            bottom: 0;
            width: 100%;
            background: linear-gradient(to top, #667eea, #764ba2);
            border-radius: 20px;
            transition: height 0.8s ease;
        }

        .mnist-app__confidence-text {
            font-size: 0.9rem;
            font-weight: 500;
            color: #666;
            margin-top: 5px;
        }

        /* í”¼ë“œë°± ì˜ì—­ ìŠ¤íƒ€ì¼ */
        .mnist-app__feedback-section {
            margin-top: 30px; /* .mnist-app__results ì™€ì˜ ê°„ê²© */
            padding: 25px;
            background: linear-gradient(135deg, #f8f9ff, #e6f3ff);
            border-radius: 15px;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.05);
            width: 100%;
            text-align: center;
            display: block; /* ê¸°ë³¸ì ìœ¼ë¡œ í‘œì‹œ */
        }

        .mnist-app__feedback-section h3 {
            margin-bottom: 20px;
            color: #333;
            font-size: 1.5rem;
        }

        .mnist-app__feedback-controls {
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .mnist-app__feedback-select {
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #ccc;
            font-size: 1rem;
        }

        .mnist-app__feedback-button {
            padding: 8px 15px;
            background: linear-gradient(45deg, #ffc107, #ff9800);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-size: 1rem;
        }

        .mnist-app__feedback-button:hover {
            background: linear-gradient(45deg, #ffb300, #f57c00);
        }

        .mnist-app__feedback-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .mnist-app__feedback-info-text {
            text-align: center;
            margin-top: 15px;
            font-size: 0.95rem;
            color: #666;
            line-height: 1.5;
        }

        /* í”¼ë“œë°± ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
        .mnist-app__feedback-message {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 30px;
            border-radius: 8px;
            z-index: 1000;
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
            font-size: 16px;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            color: white;
            opacity: 0;
            /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
            visibility: hidden;
            /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
        }

        .mnist-app__feedback-message--success {
            background-color: #4CAF50;
        }

        .mnist-app__feedback-message--error {
            background-color: #f44336;
        }

        /* ì „ì²˜ë¦¬ëœ ì´ë¯¸ì§€ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
        .debug-images-container {
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            justify-content: center;
            align-items: flex-start;
            gap: 10px;
            margin-top: 0;
            padding: 20px;
            width: 350px;
            height: auto;
            max-height: 400px;
            overflow-y: auto;
            flex-shrink: 0;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-top: none;
            border-left: 1px solid #eee;
        }

        .debug-images-container h3 {
            margin-bottom: 15px;
            /* ë²„íŠ¼ê³¼ì˜ ê°„ê²© */
            margin-top: 0;
            /* ìƒë‹¨ ë¶ˆí•„ìš”í•œ ë§ˆì§„ ì œê±° */
            width: 100%;
            /* ì œëª© ì „ì²´ ë„ˆë¹„ ì‚¬ìš© */
            color: #333;
            text-align: center;
            /* ì œëª© ì¤‘ì•™ ì •ë ¬ */
        }

        /* íˆìŠ¤í† ë¦¬ ì´ˆê¸°í™” ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        #clearHistoryBtn {
            margin-bottom: 15px;
            /* ì´ë¯¸ì§€ í•­ëª©ê³¼ì˜ ê°„ê²© */
            width: auto;
            /* ë„ˆë¹„ ìë™ ì„¤ì • */
        }

        .history-item {
            border: 1px solid #ddd;
            padding: 5px;
            border-radius: 8px;
            background-color: #fff;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            display: flex;
            /* ìì‹(ìº”ë²„ìŠ¤, ë¼ë²¨) ì •ë ¬ ìœ„í•´ flex */
            flex-direction: column;
            /* ì„¸ë¡œ ì •ë ¬ */
            text-align: center;
            align-items: center;
            /* ì•„ì´í…œ ë‚´ìš© ì¤‘ì•™ ì •ë ¬ */
            width: 80px;
            /* í•­ëª© ê³ ì • ë„ˆë¹„ (28x28 ìº”ë²„ìŠ¤ + íŒ¨ë”© ê³ ë ¤) */
            flex-basis: 80px;
            /* Flex í•­ëª©ì˜ ê¸°ë³¸ í¬ê¸° */
            flex-grow: 0;
            /* ì»¤ì§€ì§€ ì•Šë„ë¡ ì„¤ì • */
            flex-shrink: 0;
            /* ì¤„ì–´ë“¤ì§€ ì•Šë„ë¡ ì„¤ì • */
        }

        .history-item canvas {
            display: block;
            /* ìº”ë²„ìŠ¤ ì•„ë˜ ê³µë°± ì œê±° */
            margin-bottom: 5px;
            /* ë¼ë²¨ê³¼ì˜ ê°„ê²© */
        }

        .history-item div {
            font-size: 0.8em;
        }

        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .mnist-app {
                padding: 20px;
            }

            .mnist-app__title {
                font-size: 2rem;
            }

            .mnist-app__drawing-area {
                flex-direction: column;
                align-items: center;
            }

            .mnist-app__canvas-container {
                width: 100%;
                align-items: center;
            }

            .mnist-app__canvas--drawing {
                width: 250px;
                height: 250px;
            }

            .mnist-app__controls {
                flex-direction: row;
                align-items: center;
                justify-content: center;
                gap: 10px;
            }

            .mnist-app__confidence-bars {
                grid-template-columns: repeat(3, 1fr);
            }

            .mnist-app__feedback-controls {
                flex-direction: row;
                justify-content: center;
                align-items: center;
            }

            .mnist-app__feedback-select,
            .mnist-app__feedback-button {
                width: auto;
                margin-right: 0 !important;
            }

            .debug-images-container {
                width: 100%;
                max-width: none;
                height: auto;
                max-height: 300px;
                margin-top: 20px;
                border-top: 1px solid #eee;
                border-left: none;
                order: 1;
            }

            .debug-images-container h3,
            #clearHistoryBtn {
                width: auto;
                margin-left: 10px;
                margin-right: 10px;
            }

            .history-item {
                width: 60px;
                flex-basis: 60px;
            }
        }

        @media (max-width: 480px) {
            .mnist-app__confidence-bars {
                grid-template-columns: repeat(2, 1fr);
                /* ì•„ì£¼ ì‘ì€ í™”ë©´ì—ì„œ 2ê°œì”© */
            }
        }
    </style>
</head>

<body>
    <!-- ë©”ì¸ ë ˆì´ì•„ì›ƒ ì»¨í…Œì´ë„ˆ ì¶”ê°€ -->
    <div class="main-layout-container">

        <div class="mnist-app container">
            <h1 class="mnist-app__title"><span>ğŸ”¢</span> MNIST ì†ê¸€ì”¨ ì¸ì‹ê¸°</h1>

            <div class="mnist-app__instructions">
                <h3>ì‚¬ìš©ë²•</h3>
                <p>ì•„ë˜ ìº”ë²„ìŠ¤ì— 0~9 ìˆ«ìë¥¼ ê·¸ë ¤ë³´ì„¸ìš”. ì •ë°€í•œ CNN ëª¨ë¸ì´ ìˆ«ìë¥¼ ì¸ì‹í•©ë‹ˆë‹¤!</p>
            </div>

            <div class="mnist-app__status" id="modelStatus">ëª¨ë¸ ë¡œë”© ì¤‘...ì•½ 30ì´ˆ ì†Œìš”</div>

            <!-- ë¡œë”© ì»¨í…Œì´ë„ˆ ì¶”ê°€ -->
            <div class="mnist-app__loading-container" id="loadingContainer">
                <div class="mnist-app__progress-text" id="progressText">ëª¨ë¸ ì´ˆê¸°í™” ì¤‘...</div>
                <div class="mnist-app__progress-bar">
                    <div class="mnist-app__progress-fill" id="progressFill"></div>
                </div>
                <div class="mnist-app__loading-spinner"></div>
                <div class="mnist-app__loading-steps">
                    <div class="mnist-app__step" id="step1">1. TensorFlow.js ì´ˆê¸°í™”</div>
                    <div class="mnist-app__step" id="step2">2. ëª¨ë¸ ìƒì„±</div>
                    <div class="mnist-app__step" id="step3">3. ë°ì´í„° ì¤€ë¹„</div>
                    <div class="mnist-app__step" id="step4">4. ëª¨ë¸ í›ˆë ¨</div>
                </div>
            </div>

            <div class="mnist-app__drawing-area">
                <div class="drawing-and-debug-wrapper"> <!-- ìƒˆë¡œìš´ ë˜í¼ ì¶”ê°€ -->
                    <div class="mnist-app__canvas-container">
                        <canvas id="drawingCanvas" class="mnist-app__canvas--drawing" width="280" height="280" role="img"
                            aria-label="ìˆ«ì ì†ê¸€ì”¨ ì…ë ¥ ì˜ì—­" title="ìˆ«ì ì†ê¸€ì”¨ë¥¼ ê·¸ë¦¬ëŠ” ì˜ì—­ì…ë‹ˆë‹¤."></canvas>
                        <div class="mnist-app__controls">
                            <button class="mnist-app__button mnist-app__button--clear" id="clearBtn" aria-label="ìº”ë²„ìŠ¤ ì§€ìš°ê¸°"
                                title="ê·¸ë¦¼íŒì„ ì§€ì›ë‹ˆë‹¤.">ğŸ—‘ï¸ ì§€ìš°ê¸°</button>
                            <button class="mnist-app__button mnist-app__button--predict" id="predictBtn" disabled
                                aria-label="ì†ê¸€ì”¨ ì¸ì‹í•˜ê¸°" title="ê·¸ë¦° ì†ê¸€ì”¨ë¥¼ ì¸ê³µì§€ëŠ¥ìœ¼ë¡œ ì¸ì‹í•©ë‹ˆë‹¤.">ğŸ” ì¸ì‹í•˜ê¸°</button>
                        </div>
                    </div>

                    <!-- ì „ì²˜ë¦¬ëœ ì´ë¯¸ì§€ ì»¨í…Œì´ë„ˆë¥¼ ì—¬ê¸°ë¡œ ì´ë™ -->
                    <div id="debugImagesContainer" class="debug-images-container">
                        <h3>ì „ì²˜ë¦¬ëœ ì´ë¯¸ì§€ í™•ì¸ (ë””ë²„ê¹…ìš©)</h3>
                        <button id="clearHistoryBtn" class="mnist-app__button mnist-app__button--clear"
                            style="margin-bottom: 15px; width: auto;">íˆìŠ¤í† ë¦¬ ì´ˆê¸°í™”</button>
                        <!-- íˆìŠ¤í† ë¦¬ ì•„ì´í…œë“¤ì€ JavaScriptë¡œ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </div>
                </div>

                <div class="mnist-app__feedback-section">
                    <h3>ì´ ìˆ«ìê°€ ë§ë‚˜ìš”?</h3>
                    
                    <div class="mnist-app__feedback-controls">
                        <select id="correctDigit" class="mnist-app__feedback-select" aria-label="ì •ë‹µ ìˆ«ì ì„ íƒ"
                            title="ì¸ê³µì§€ëŠ¥ ì˜ˆì¸¡ì´ í‹€ë ¸ì„ ê²½ìš° ì˜¬ë°”ë¥¸ ìˆ«ìë¥¼ ì„ íƒí•˜ì—¬ í”¼ë“œë°±í•©ë‹ˆë‹¤.">
                            <option value="-1">ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                        </select>
                        <button id="sendFeedbackBtn" class="mnist-app__feedback-button">í”¼ë“œë°± ë³´ë‚´ê¸°</button>
                    </div>
                    <div class="mnist-app__feedback-info-text">
                        ì˜ëª»ëœ í”¼ë“œë°±, í‹€ë¦° ìˆ«ìë¥¼ ë¼ë²¨ë§í•˜ëŠ” ê²½ìš°ê°€ ìˆì–´, <br>ë§¤ì¼ ìˆ«ìë°ì´í„°ëŠ” ì´ˆê¸°í™” ë©ë‹ˆë‹¤.
                    </div>
                </div>
            </div>

            <div class="mnist-app__results" id="results" style="display: none;">
                <div class="mnist-app__prediction-result" id="predictionResult">ì˜ˆì¸¡ ê²°ê³¼</div>
                <div class="mnist-app__confidence-bars">
                    <div class="mnist-app__confidence-item">
                        <div class="mnist-app__digit-label">0</div>
                        <div class="mnist-app__confidence-bar">
                            <div class="mnist-app__confidence-fill" id="conf-0"></div>
                        </div>
                        <div class="mnist-app__confidence-text" id="conf-text-0">0%</div>
                    </div>
                    <div class="mnist-app__confidence-item">
                        <div class="mnist-app__digit-label">1</div>
                        <div class="mnist-app__confidence-bar">
                            <div class="mnist-app__confidence-fill" id="conf-1"></div>
                        </div>
                        <div class="mnist-app__confidence-text" id="conf-text-1">0%</div>
                    </div>
                    <div class="mnist-app__confidence-item">
                        <div class="mnist-app__digit-label">2</div>
                        <div class="mnist-app__confidence-bar">
                            <div class="mnist-app__confidence-fill" id="conf-2"></div>
                        </div>
                        <div class="mnist-app__confidence-text" id="conf-text-2">0%</div>
                    </div>
                    <div class="mnist-app__confidence-item">
                        <div class="mnist-app__digit-label">3</div>
                        <div class="mnist-app__confidence-bar">
                            <div class="mnist-app__confidence-fill" id="conf-3"></div>
                        </div>
                        <div class="mnist-app__confidence-text" id="conf-text-3">0%</div>
                    </div>
                    <div class="mnist-app__confidence-item">
                        <div class="mnist-app__digit-label">4</div>
                        <div class="mnist-app__confidence-bar">
                            <div class="mnist-app__confidence-fill" id="conf-4"></div>
                        </div>
                        <div class="mnist-app__confidence-text" id="conf-text-4">0%</div>
                    </div>
                    <div class="mnist-app__confidence-item">
                        <div class="mnist-app__digit-label">5</div>
                        <div class="mnist-app__confidence-bar">
                            <div class="mnist-app__confidence-fill" id="conf-5"></div>
                        </div>
                        <div class="mnist-app__confidence-text" id="conf-text-5">0%</div>
                    </div>
                    <div class="mnist-app__confidence-item">
                        <div class="mnist-app__digit-label">6</div>
                        <div class="mnist-app__confidence-bar">
                            <div class="mnist-app__confidence-fill" id="conf-6"></div>
                        </div>
                        <div class="mnist-app__confidence-text" id="conf-text-6">0%</div>
                    </div>
                    <div class="mnist-app__confidence-item">
                        <div class="mnist-app__digit-label">7</div>
                        <div class="mnist-app__confidence-bar">
                            <div class="mnist-app__confidence-fill" id="conf-7"></div>
                        </div>
                        <div class="mnist-app__confidence-text" id="conf-text-7">0%</div>
                    </div>
                    <div class="mnist-app__confidence-item">
                        <div class="mnist-app__digit-label">8</div>
                        <div class="mnist-app__confidence-bar">
                            <div class="mnist-app__confidence-fill" id="conf-8"></div>
                        </div>
                        <div class="mnist-app__confidence-text" id="conf-text-8">0%</div>
                    </div>
                    <div class="mnist-app__confidence-item">
                        <div class="mnist-app__digit-label">9</div>
                        <div class="mnist-app__confidence-bar">
                            <div class="mnist-app__confidence-fill" id="conf-9"></div>
                        </div>
                        <div class="mnist-app__confidence-text" id="conf-text-9">0%</div>
                    </div>
                </div>
            </div>
        </div>

    </div> <!-- .main-layout-container ë‹«ëŠ” íƒœê·¸ -->

    <!-- í”¼ë“œë°±/ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ ì˜ì—­ -->
    <div id="systemMessage" class="mnist-app__feedback-message" role="alert"></div>

    <script>
        // ===============================================
        // ì „ì—­ ë³€ìˆ˜ ë° ì´ˆê¸° ì„¤ì •
        // ===============================================
        const canvas = document.getElementById('drawingCanvas');
        const ctx = canvas.getContext('2d');
        let isDrawing = false;
        let modelReady = false; // ì„œë²„ ëª¨ë¸ ì¤€ë¹„ ìƒíƒœ

        // Canvas ìŠ¤íƒ€ì¼ ì„¤ì •
        ctx.strokeStyle = '#000';
        ctx.lineWidth = 12;
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';

        // History ê´€ë¦¬ë¥¼ ìœ„í•œ í´ë˜ìŠ¤ ì¶”ê°€
        class HistoryManager {
            constructor() {
                this.history = [];
                this.container = document.getElementById('debugImagesContainer'); // ì´ì œ HTMLì— ì§ì ‘ ìˆìŒ
                this.storageKey = 'mnist_history'; // Local Storage í‚¤ ì„¤ì •
                this.maxHistoryItems = 20; // ìµœëŒ€ ì €ì¥ ê°œìˆ˜ ì„¤ì • (ì˜ˆ: 20ê°œ)
            }

            // Local Storageì—ì„œ íˆìŠ¤í† ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°
            async loadHistory() {
                const storedHistory = localStorage.getItem(this.storageKey);
                if (storedHistory) {
                    try {
                        const parsedHistory = JSON.parse(storedHistory);
                        const loadedItems = []; // ë¶ˆëŸ¬ì˜¨ ìœ íš¨ í•­ëª©ë“¤ì„ ë‹´ì„ ë°°ì—´

                        // ê¸°ì¡´ ë Œë”ë§ëœ í•­ëª© ì§€ìš°ê¸° (loadHistoryëŠ” ëª¨ë“  í•­ëª©ì„ ë‹¤ì‹œ ê·¸ë¦¼)
                        if (this.container) {
                            while (this.container.children.length > 1) { // ì²« ë²ˆì§¸ ìì‹(h3) ì œì™¸
                                this.container.removeChild(this.container.lastChild);
                            }
                        }

                        // ë¶ˆëŸ¬ì˜¨ ê° í•­ëª©ì˜ Base64 URLì„ ImageData ê°ì²´ë¡œ ë³€í™˜
                        for (const item of parsedHistory) { // ë¹„ë™ê¸°ë¥¼ ìœ„í•´ for...of ì‚¬ìš©
                            if (!item.imageDataUrl) continue; // ì´ë¯¸ì§€ ë°ì´í„° ì—†ìœ¼ë©´ ê±´ë„ˆë›°ê¸°

                            const img = new Image();
                            img.src = item.imageDataUrl; // ì €ì¥ëœ Base64 URL ì‚¬ìš©

                            try {
                                // ì´ë¯¸ì§€ê°€ ë¡œë“œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.
                                await new Promise((resolve, reject) => {
                                    img.onload = resolve;
                                    img.onerror = (e) => { // ì˜¤ë¥˜ ì²˜ë¦¬ ì¶”ê°€
                                        console.warn('íˆìŠ¤í† ë¦¬ ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨, í•­ëª© ê±´ë„ˆë›°ê¸°', item.timestamp, e);
                                        resolve(); // ì˜¤ë¥˜ ë°œìƒ ì‹œì—ë„ resolve í˜¸ì¶œí•˜ì—¬ ê³„ì† ì§„í–‰
                                    };
                                });

                                if (!img.naturalWidth || !img.naturalHeight) { // ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨ í™•ì¸
                                    console.warn('íˆìŠ¤í† ë¦¬ ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨ (empty image), í•­ëª© ê±´ë„ˆë›°ê¸°', item.timestamp);
                                    continue; // ìœ íš¨í•˜ì§€ ì•Šì€ ì´ë¯¸ì§€ ê±´ë„ˆë›°ê¸°
                                }

                                const canvas = document.createElement('canvas');
                                canvas.width = img.width; // ì´ë¯¸ì§€ ì‹¤ì œ ë„ˆë¹„ ì‚¬ìš©
                                canvas.height = img.height; // ì´ë¯¸ì§€ ì‹¤ì œ ë†’ì´ ì‚¬ìš©
                                const ctx = canvas.getContext('2d');

                                ctx.drawImage(img, 0, 0); // ì´ë¯¸ì§€ ê·¸ë¦¬ê¸°
                                const imageData = ctx.getImageData(0, 0, img.width, img.height); // ImageData ê°€ì ¸ì˜¤ê¸°

                                // ì›ë³¸ í•­ëª©ì˜ ë‹¤ë¥¸ ì†ì„±ê³¼ í•¨ê»˜ ImageData ì €ì¥
                                loadedItems.push({ ...item, imageData: imageData });

                            } catch (e) {
                                console.error('íˆìŠ¤í† ë¦¬ ì´ë¯¸ì§€ ë Œë”ë§ ì¤‘ ì˜¤ë¥˜ ë°œìƒ', item.timestamp, e);
                                // ì˜¤ë¥˜ ë°œìƒ ì‹œ í•´ë‹¹ í•­ëª©ì€ íˆìŠ¤í† ë¦¬ì— ì¶”ê°€í•˜ì§€ ì•ŠìŒ
                            }
                        }

                        this.history = loadedItems; // ìœ íš¨í•œ í•­ëª©ë“¤ë¡œ íˆìŠ¤í† ë¦¬ ë°°ì—´ ì—…ë°ì´íŠ¸
                        console.log(`Local Storageì—ì„œ ${this.history.length}ê°œì˜ ìœ íš¨í•œ íˆìŠ¤í† ë¦¬ í•­ëª©ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.`);

                        // ë¶ˆëŸ¬ì˜¨ ëª¨ë“  í•­ëª©ì„ í™”ë©´ì— ë‹¤ì‹œ ë Œë”ë§
                        this.renderAllHistoryItems();

                    } catch (e) {
                        console.error('Local Storage íˆìŠ¤í† ë¦¬ êµ¬ë¬¸ ë¶„ì„ ì˜¤ë¥˜:', e);
                        localStorage.removeItem(this.storageKey); // íŒŒì‹± ì˜¤ë¥˜ ì‹œ ë°ì´í„° ì‚­ì œ
                        this.history = []; // íˆìŠ¤í† ë¦¬ ì´ˆê¸°í™”
                    }
                } else {
                    console.log('Local Storageì—ì„œ íˆìŠ¤í† ë¦¬ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    this.history = []; // ì €ì¥ëœ íˆìŠ¤í† ë¦¬ê°€ ì—†ìœ¼ë©´ ë¹ˆ ë°°ì—´ë¡œ ì´ˆê¸°í™”
                }
            }

            // íˆìŠ¤í† ë¦¬ í•­ëª© ì „ì²´ë¥¼ DOMì— ë Œë”ë§í•˜ëŠ” í•¨ìˆ˜ ì¶”ê°€
            renderAllHistoryItems() {
                if (this.container) {
                    // ê¸°ì¡´ ë Œë”ë§ëœ í•­ëª© ëª¨ë‘ ì§€ìš°ê¸° (h3 íƒœê·¸ ì œì™¸)
                    while (this.container.children.length > 1) {
                        this.container.removeChild(this.container.lastChild);
                    }
                    // í˜„ì¬ íˆìŠ¤í† ë¦¬ ë°°ì—´ì˜ ëª¨ë“  í•­ëª© ë‹¤ì‹œ ê·¸ë¦¬ê¸°
                    this.history.forEach(item => this.renderHistoryItem(item));
                    console.log('ëª¨ë“  íˆìŠ¤í† ë¦¬ í•­ëª© ë‹¤ì‹œ ë Œë”ë§ ì™„ë£Œ.');
                } else {
                    console.error('HistoryManager: debugImagesContainerë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. íˆìŠ¤í† ë¦¬ë¥¼ ë Œë”ë§í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
            }

            renderHistoryItem(item) {
                // loadHistoryì™€ addImage ëª¨ë‘ì—ì„œ í˜¸ì¶œ ê°€ëŠ¥. ì‹¤ì œ DOM ì¶”ê°€ ë° ì´ë¯¸ì§€ ê·¸ë¦¼.
                // ì „ë‹¬ë°›ì€ item ê°ì²´ëŠ” ë°˜ë“œì‹œ imageData ì†ì„±ì„ ê°€ì ¸ì•¼ í•¨.

                if (!item.imageData || !(item.imageData instanceof ImageData)) { // ImageData ê°ì²´ì¸ì§€ ëª…ì‹œì  í™•ì¸
                    console.error('renderHistoryItem: ìœ íš¨í•œ ImageData ê°ì²´ê°€ ì—†ì–´ ë Œë”ë§í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', item);
                    return; // ìœ íš¨í•œ ImageData ì—†ìœ¼ë©´ ë Œë”ë§í•˜ì§€ ì•ŠìŒ
                }

                const imgWrapper = document.createElement('div');
                imgWrapper.className = 'history-item';

                const canvas = document.createElement('canvas');
                canvas.width = item.imageData.width; // ImageDataì˜ ì‹¤ì œ í¬ê¸° ì‚¬ìš©
                canvas.height = item.imageData.height; // ImageDataì˜ ì‹¤ì œ í¬ê¸° ì‚¬ìš©
                const ctx = canvas.getContext('2d');
                // ImageData ê°ì²´ë¥¼ ìº”ë²„ìŠ¤ì— ê·¸ë¦½ë‹ˆë‹¤.
                ctx.putImageData(item.imageData, 0, 0);

                const label = document.createElement('div');
                label.textContent = `${item.type === 'prediction' ? 'ì˜ˆì¸¡' : 'í”¼ë“œë°±'}: ${item.label}`;
                label.style.color = item.type === 'prediction' ? '#667eea' : '#16a34a'; // CSSì—ì„œ ì²˜ë¦¬

                imgWrapper.appendChild(canvas);
                imgWrapper.appendChild(label);

                if (this.container) {
                    // ìƒˆ í•­ëª©ì„ í•­ìƒ ì»¨í…Œì´ë„ˆì˜ ë§¨ ë’¤ì— ì¶”ê°€í•˜ì—¬ ì‹œê°„ìˆœìœ¼ë¡œ ì •ë ¬
                    this.container.appendChild(imgWrapper);
                } else {
                    console.error('HistoryManager: debugImagesContainerë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. íˆìŠ¤í† ë¦¬ë¥¼ ë Œë”ë§í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
            }

            addImage(imageData, label, type = 'prediction') {
                const historyItem = {
                    imageData,
                    label,
                    type,
                    timestamp: new Date().toISOString()
                };

                // ìƒˆ í•­ëª©ì„ ë°°ì—´ì˜ ëì— ì¶”ê°€
                this.history.push(historyItem);

                // ìµœëŒ€ ê°œìˆ˜ ì´ˆê³¼ ì‹œ ì˜¤ë˜ëœ í•­ëª© ì œê±°
                while (this.history.length > this.maxHistoryItems) {
                    const oldestItem = this.history.shift();
                    console.log('íˆìŠ¤í† ë¦¬ ìµœëŒ€ ê°œìˆ˜ ì´ˆê³¼, ê°€ì¥ ì˜¤ë˜ëœ í•­ëª© ì œê±°ë¨.', oldestItem.timestamp);
                }

                // Local Storage ì €ì¥ (ë³€ê²½ ì‚¬í•­ ë°˜ì˜) - ImageDataë¥¼ Base64ë¡œ ë³€í™˜í•˜ì—¬ ì €ì¥
                this.saveHistory();
                this.renderAllHistoryItems();
            }

            // íˆìŠ¤í† ë¦¬ Local Storageì— ì €ì¥ í•¨ìˆ˜ ì¶”ê°€
            saveHistory() {
                try {
                    const historyToStore = this.history.map(item => ({
                        imageDataUrl: this.imageDataToBase64(item.imageData),
                        label: item.label,
                        type: item.type,
                        timestamp: item.timestamp
                    }));
                    localStorage.setItem(this.storageKey, JSON.stringify(historyToStore));
                } catch (e) {
                    console.error('Failed to save history to Local Storage:', e);
                }
            }

            // ImageData ê°ì²´ë¥¼ Base64 Data URLë¡œ ë³€í™˜í•˜ëŠ” í—¬í¼ í•¨ìˆ˜
            imageDataToBase64(imageData) {
                const canvas = document.createElement('canvas');
                canvas.width = imageData.width;
                canvas.height = imageData.height;
                const ctx = canvas.getContext('2d');
                ctx.putImageData(imageData, 0, 0);
                return canvas.toDataURL('image/png');
            }

            clear() {
                this.history = [];
                if (this.container) {
                    while (this.container.children.length > 1) {
                        this.container.removeChild(this.container.lastChild);
                    }
                }
                // Local Storageì—ì„œë„ íˆìŠ¤í† ë¦¬ ì œê±° í›„ ì €ì¥ (clearì—ì„œë„ saveHistory í˜¸ì¶œ)
                this.saveHistory();
                console.log('History cleared from memory and Local Storage.');
            }
        } // HistoryManager í´ë˜ìŠ¤ ì •ì˜ ë‹«ê¸°

        // ì „ì—­ íˆìŠ¤í† ë¦¬ ë§¤ë‹ˆì € ì¸ìŠ¤í„´ìŠ¤ ìƒì„± (HistoryManager í´ë˜ìŠ¤ ì •ì˜ í›„)
        const historyManager = new HistoryManager();

        // ë¸Œë¼ìš°ì € ë’¤ë¡œê°€ê¸° ì‹œ ì •ë¦¬ (TensorFlow.js ë©”ëª¨ë¦¬ ì •ë¦¬, ìœ ì§€)
        window.addEventListener('beforeunload', () => {
            if (typeof tf !== 'undefined') {
                tf.disposeVariables();
            }
        });

        // í•„ê¸°ì²´ ìŠ¤íƒ€ì¼ ëœë¤ ê³¡ì„  í•¨ìˆ˜ (ìº”ë²„ìŠ¤ ê·¸ë¦¬ê¸°ìš©, ìœ ì§€)
        function drawHandwrittenCurve(ctx, points) {
            ctx.beginPath();
            ctx.moveTo(points[0][0], points[0][1]);
            for (let i = 1; i < points.length; i++) {
                const [x, y] = points[i];
                ctx.lineTo(x + (Math.random() - 0.5) * 2, y + (Math.random() - 0.5) * 2);
            }
            ctx.stroke();
        }

        // ë°ì´í„° ì¦ê°• í•¨ìˆ˜ (ì´ì œ í´ë¼ì´ì–¸íŠ¸ ì „ì²˜ë¦¬ìš©, ìœ ì§€)
        function augmentData(image) {
            const augmented = tf.tidy(() => {
                // ëœë¤ íšŒì „ (-15ë„ ~ 15ë„)
                const rotation = tf.image.rotateWithOffset(image, (Math.random() - 0.5) * 0.3);

                // ëœë¤ í™•ëŒ€/ì¶•ì†Œ (0.9 ~ 1.1)
                const scale = 0.9 + Math.random() * 0.2;
                const scaled = tf.image.resizeBilinear(rotation, [28, 28]);

                return scaled;
            });
            return augmented;
        }

        // ì´ë¯¸ì§€ ì „ì²˜ë¦¬ í•¨ìˆ˜ (í´ë¼ì´ì–¸íŠ¸ ì „ì²˜ë¦¬ìš©, ìœ ì§€)
        function preprocessCanvas() {
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;

            // ê²½ê³„ ë°•ìŠ¤ ì°¾ê¸°
            let minX = canvas.width, minY = canvas.height, maxX = 0, maxY = 0;
            let hasContent = false;

            for (let y = 0; y < canvas.height; y++) {
                for (let x = 0; x < canvas.width; x++) {
                    const alpha = data[(y * canvas.width + x) * 4 + 3];
                    if (alpha > 10) { // íˆ¬ëª…ë„ê°€ 10ë³´ë‹¤ í¬ë©´ ë‚´ìš©ìœ¼ë¡œ ê°„ì£¼
                        hasContent = true;
                        minX = Math.min(minX, x);
                        minY = Math.min(minY, y);
                        maxX = Math.max(maxX, x);
                        maxY = Math.max(maxY, y);
                    }
                }
            }

            // ìº”ë²„ìŠ¤ê°€ ë¹„ì–´ ìˆìœ¼ë©´ null ë˜ëŠ” íŠ¹ì • ê°’ ë°˜í™˜í•˜ì—¬ ì˜ˆì¸¡ ë°©ì§€
            if (!hasContent) {
                console.log('preprocessCanvas: ìº”ë²„ìŠ¤ì— ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.');
                return null; // ë‚´ìš©ì´ ì—†ìŒì„ ë‚˜íƒ€ë‚´ê¸° ìœ„í•´ null ë°˜í™˜
            }

            // ì—¬ë°± ì¶”ê°€ ë° ì •ê·œí™”
            const padding = 20;
            minX = Math.max(0, minX - padding);
            minY = Math.max(0, minY - padding);
            maxX = Math.min(canvas.width, maxX + padding);
            maxY = Math.min(canvas.height, maxY + padding);

            const boundingWidth = maxX - minX;
            const boundingHeight = maxY - minY;
            const maxDim = Math.max(boundingWidth, boundingHeight);

            // ì •ì‚¬ê°í˜•ìœ¼ë¡œ í¬ë¡­
            const centerX = (minX + maxX) / 2;
            const centerY = (minY + maxY) / 2;
            const cropX = centerX - maxDim / 2;
            const cropY = centerY - maxDim / 2;

            // 28x28ë¡œ ë¦¬ì‚¬ì´ì¦ˆ
            const resizeCanvas = document.createElement('canvas');
            resizeCanvas.width = 28;
            resizeCanvas.height = 28;
            const resizeCtx = resizeCanvas.getContext('2d');

            resizeCtx.fillStyle = 'white';
            resizeCtx.fillRect(0, 0, 28, 28);
            resizeCtx.drawImage(canvas, cropX, cropY, maxDim, maxDim, 0, 0, 28, 28);

            // í…ì„œë¡œ ë³€í™˜ ë° ì •ê·œí™”
            const resizedImageData = resizeCtx.getImageData(0, 0, 28, 28);
            const resizedData = resizedImageData.data;
            const input = new Float32Array(28 * 28);

            for (let i = 0; i < 28 * 28; i++) {
                const pixelIndex = i * 4;
                const gray = (resizedData[pixelIndex] + resizedData[pixelIndex + 1] + resizedData[pixelIndex + 2]) / 3;
                input[i] = (255 - gray) / 255; // 0-1 ë²”ìœ„ë¡œ ì •ê·œí™” ë° ìƒ‰ìƒ ë°˜ì „ (ì–´ë‘ìš´ ë°°ê²½ 0, ë°ì€ ê¸€ì”¨ 1)
            }

            // ë°ì´í„° ì¦ê°• ì ìš© (ì˜ˆì¸¡ ì‹œì ì—ëŠ” ì ìš©í•˜ì§€ ì•ŠìŒ)
            const tensor = tf.tensor4d(input, [1, 28, 28, 1]); // [Batch size, Height, Width, Channels]
            return tensor; // ì¦ê°• ì—†ì´ ì›ë³¸ í…ì„œ ë°˜í™˜
        }

        // ëª¨ë¸ ë¶ˆëŸ¬ì˜¤ê¸° ë˜ëŠ” ìƒˆë¡œ í•™ìŠµ (ì´ì œ ì„œë²„ ìƒíƒœ í™•ì¸ ì‹œì‘ ì—­í• , í•¨ìˆ˜ëª… ìœ ì§€)
        async function loadOrCreateModel() {
            if (typeof tf !== 'undefined' && !tf.ready) {
                await tf.ready();
            }
            console.log('TensorFlow.js ì´ˆê¸°í™” ì™„ë£Œ (í´ë¼ì´ì–¸íŠ¸ ì „ì²˜ë¦¬ìš©).');
        }

        // í„°ì¹˜ ë° ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ ì²˜ë¦¬ (ìœ ì§€)
        function getTouchPos(e) {
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;

            if (e.touches && e.touches[0]) {
                return {
                    x: (e.touches[0].clientX - rect.left) * scaleX,
                    y: (e.touches[0].clientY - rect.top) * scaleY
                };
            } else {
                return {
                    x: (e.clientX - rect.left) * scaleX,
                    y: (e.clientY - rect.top) * scaleY
                };
            }
        }

        // ì‹œìŠ¤í…œ ë©”ì‹œì§€(ì„±ê³µ/ì˜¤ë¥˜) í‘œì‹œ í•¨ìˆ˜ (ìœ ì§€)
        function showSystemMessage(message, type) {
            const messageElement = document.getElementById('systemMessage');
            if (!messageElement) return; // ìš”ì†Œ ì—†ìœ¼ë©´ ì¤‘ë‹¨

            messageElement.textContent = message;
            messageElement.className = 'mnist-app__feedback-message'; // ê¸°ë³¸ í´ë˜ìŠ¤ë¡œ ì´ˆê¸°í™”
            messageElement.classList.add(`mnist-app__feedback-message--${type}`); // íƒ€ì…ë³„ í´ë˜ìŠ¤ ì¶”ê°€

            messageElement.style.opacity = '1';
            messageElement.style.visibility = 'visible';
            messageElement.style.transform = 'translateX(-50%) translateY(0px)';

            // 5ì´ˆ í›„ ë©”ì‹œì§€ ì‚¬ë¼ì§€ê²Œ í•˜ê¸°
            setTimeout(() => {
                messageElement.style.opacity = '0';
                messageElement.style.transform = 'translateX(-50%) translateY(-10px)';
                setTimeout(() => {
                    messageElement.style.visibility = 'hidden'; // ì™„ì „íˆ ìˆ¨ê¹€
                }, 500); // opacity transition ì‹œê°„ê³¼ ì¼ì¹˜
            }, 5000); // ë©”ì‹œì§€ í‘œì‹œ ì‹œê°„ (5ì´ˆ)
        }


        // ëª¨ë¸ ì´ˆê¸°í™” (ì´ì œ ì„œë²„ ìƒíƒœ í™•ì¸ ë° UI ì—…ë°ì´íŠ¸ ì—­í• )
        async function initServerStatusCheck() {
            const statusElement = document.getElementById('modelStatus');
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            const loadingContainer = document.getElementById('loadingContainer');
            const predictBtn = document.getElementById('predictBtn');

            // ì´ˆê¸° ìƒíƒœ ì„¤ì •
            statusElement.textContent = 'ì„œë²„ ì—°ê²° ì¤‘...';
            statusElement.className = 'mnist-app__status mnist-app__status--loading'; // CSS í´ë˜ìŠ¤ì— ë§ê²Œ ìˆ˜ì •
            progressFill.style.width = '0%';
            progressText.textContent = 'ì„œë²„ ì‘ë‹µ ëŒ€ê¸° ì¤‘...(ì•½ 30ì´ˆ ì†Œìš”)';
            const loadingSteps = document.querySelector('.mnist-app__loading-steps');
            if (loadingSteps) loadingSteps.style.display = 'none';

            if (predictBtn) predictBtn.disabled = true; // ì„œë²„ ì¤€ë¹„ë  ë•Œê¹Œì§€ ë²„íŠ¼ ë¹„í™œì„±í™”

            // ì„œë²„ ìƒíƒœ í™•ì¸ì„ ìœ„í•œ URL (ì˜ˆì¸¡ ì—”ë“œí¬ì¸íŠ¸ ì‚¬ìš©)
            const serverStatusUrl = 'https://tjdgus1121-github-io.onrender.com/'; // ì„œë²„ ê¸°ë³¸ ê²½ë¡œë¡œ ë³€ê²½
            let retryCount = 0;
            const maxRetries = 10; // ìµœëŒ€ ì¬ì‹œë„ íšŸìˆ˜
            const retryDelay = 3000; // ì¬ì‹œë„ ê°„ê²© (ë°€ë¦¬ì´ˆ)

            while (retryCount < maxRetries) {
                try {
                    console.log(`ì„œë²„ ìƒíƒœ í™•ì¸ ì‹œë„ ${retryCount + 1}/${maxRetries}: ${serverStatusUrl}`);
                    // ì„œë²„ ê¸°ë³¸ ê²½ë¡œì— HEAD ìš”ì²­ ë³´ë‚´ê¸°
                    const response = await fetch(serverStatusUrl, { method: 'HEAD' });

                    if (response.ok) { // 200 OK ì‘ë‹µë§Œ ì„±ê³µìœ¼ë¡œ ê°„ì£¼
                        console.log('ì„œë²„ ì˜ˆì¸¡ ì—”ë“œí¬ì¸íŠ¸ ì‘ë‹µ í™•ì¸.');
                        statusElement.textContent = 'ì„œë²„ ì¤€ë¹„ ì™„ë£Œ! ì‚¬ìš© ê°€ëŠ¥.';
                        statusElement.className = 'mnist-app__status mnist-app__status--ready'; // CSS í´ë˜ìŠ¤ì— ë§ê²Œ ìˆ˜ì •
                        progressFill.style.width = '100%';
                        progressText.textContent = 'ëª¨ë“  ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥';
                        if (predictBtn) predictBtn.disabled = false; // ì„œë²„ ì¤€ë¹„ ì™„ë£Œ ì‹œ ë²„íŠ¼ í™œì„±í™”

                        // ë¡œë”© ì»¨í…Œì´ë„ˆ ìˆ¨ê¸°ê¸°
                        setTimeout(() => {
                            if (loadingContainer) loadingContainer.style.display = 'none';
                        }, 1000);

                        modelReady = true; // ì„œë²„ ì¤€ë¹„ ì™„ë£Œ ìƒíƒœ ë³€ìˆ˜
                        return; // ì„±ê³µì ìœ¼ë¡œ ì—°ê²°ë˜ë©´ í•¨ìˆ˜ ì¢…ë£Œ
                    }

                    console.warn(`ì„œë²„ ìƒíƒœ í™•ì¸ ì‘ë‹µ ì½”ë“œ: ${response.status}. ì¬ì‹œë„...`);

                } catch (error) {
                    console.error(`ì„œë²„ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨: ${error}. ì¬ì‹œë„...`);
                }

                retryCount++;
                if (progressFill) progressFill.style.width = `${(retryCount / maxRetries) * 100}%`;
                if (progressText) progressText.textContent = `ì„œë²„ ì—°ê²° ì‹¤íŒ¨. ì¬ì‹œë„ ì¤‘... (${retryCount}/${maxRetries})`;
                await new Promise(resolve => setTimeout(resolve, retryDelay)); // ì§€ì—° í›„ ì¬ì‹œë„
            }

            // ìµœëŒ€ ì¬ì‹œë„ í›„ì—ë„ ì—°ê²° ì‹¤íŒ¨
            console.error('ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‚˜ì¤‘ì— ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
            if (statusElement) {
                statusElement.textContent = 'ì„œë²„ ì—°ê²° ì‹¤íŒ¨. ë‚˜ì¤‘ì— ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.';
                statusElement.style.color = '#ef4444';
                statusElement.className = 'mnist-app__status'; // ê¸°ë³¸ ìƒíƒœ í´ë˜ìŠ¤ë¡œ ì´ˆê¸°í™”
            }
            if (progressText) progressText.textContent = 'ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
            if (progressFill) progressFill.style.background = '#ef4444';
            if (predictBtn) predictBtn.disabled = true; // ì—°ê²° ì‹¤íŒ¨ ì‹œ ë²„íŠ¼ ë¹„í™œì„±í™” ìœ ì§€
            modelReady = false; // ì„œë²„ ì¤€ë¹„ ì•ˆ ë¨ ìƒíƒœ
        }

        // Canvas ì§€ìš°ê¸°
        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            // ì˜ˆì¸¡ ê²°ê³¼ ë° í”¼ë“œë°± ì˜ì—­ ìˆ¨ê¹€
            const resultsDiv = document.getElementById('results');
            if (resultsDiv) resultsDiv.style.display = 'none';
        }

        // ì„œë²„ë¡œ ì´ë¯¸ì§€ ì „ì†¡ ë° ì˜ˆì¸¡ ê²°ê³¼ ë°›ê¸°
        async function predictWithServer() {
            if (!modelReady) {
                showSystemMessage('ì„œë²„ê°€ ì•„ì§ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }

            // ë¹ˆ ìº”ë²„ìŠ¤ ì²´í¬
            const processedTensor = preprocessCanvas(); // preprocessCanvasì—ì„œ null ë°˜í™˜ ì‹œ ê·¸ë¦¼ ì—†ìŒ
            if (processedTensor === null) {
                showSystemMessage('ìˆ«ìë¥¼ ê·¸ë ¤ì£¼ì„¸ìš”!', 'error');
                return;
            }

            let imgArray = null; // try ë¸”ë¡ ì™¸ë¶€ì—ì„œ ì„ ì–¸í•˜ì—¬ finallyì—ì„œ dispose ê°€ëŠ¥í•˜ê²Œ í•¨
            let flatArray = null;
            let grayScalePixels = null;
            let imgData = null;
            let predictedDigit = null;
            let probabilities = null;

            try {
                imgArray = await processedTensor.array();

                flatArray = imgArray[0].flat();
                grayScalePixels = new Uint8ClampedArray(28 * 28 * 4);

                for (let i = 0; i < 28 * 28; i++) {
                    const gray = Math.round((1 - flatArray[i]) * 255);
                    grayScalePixels[i * 4 + 0] = gray;
                    grayScalePixels[i * 4 + 1] = gray;
                    grayScalePixels[i * 4 + 2] = gray;
                    grayScalePixels[i * 4 + 3] = 255;
                }

                imgData = new ImageData(grayScalePixels, 28, 28);
                const tempCanvas = document.createElement('canvas');
                tempCanvas.width = 28;
                tempCanvas.height = 28;
                const tempCtx = tempCanvas.getContext('2d');
                tempCtx.putImageData(imgData, 0, 0);

                const imgDataUrl = tempCanvas.toDataURL('image/png');
                let imgBase64 = imgDataUrl.split(',')[1];

                // ì˜ˆì¸¡ ìš”ì²­ì„ /predict ì—”ë“œí¬ì¸íŠ¸ë¡œ ë³´ë‚´ë„ë¡ URL ìˆ˜ì •
                const serverUrl = 'https://tjdgus1121-github-io.onrender.com/predict';

                const response = await fetch(serverUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    // /predict ì—”ë“œí¬ì¸íŠ¸ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì´ë¯¸ì§€ ë°ì´í„°ë§Œ í•„ìš”í•˜ë¯€ë¡œ label ì œê±°
                    body: JSON.stringify({ image: imgBase64 })
                });

                if (!response.ok) {
                    // ì„œë²„ ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ë²ˆëŒ€ê°€ ì•„ë‹Œ ê²½ìš°
                    const errorText = await response.text(); // ì„œë²„ì—ì„œ ë³´ë‚¸ ì˜¤ë¥˜ ì‘ë‹µ ë³¸ë¬¸ ì½ê¸°
                    throw new Error(`HTTP error! status: ${response.status}. Details: ${errorText}`);
                }

                const result = await response.json();

                // ì„œë²„ ì‘ë‹µ ìœ íš¨ì„± ê²€ì‚¬: predictedDigit ë° probabilities í•„ë“œ í™•ì¸
                if (typeof result.result === 'undefined' || !Array.isArray(result.probs) || result.probs.length !== 10) {
                    console.error('Invalid server response format:', result);
                    throw new Error('ì„œë²„ ì‘ë‹µ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.'); // ì˜ˆìƒì¹˜ ëª»í•œ ì‘ë‹µ í˜•ì‹ì— ëŒ€í•œ ì˜¤ë¥˜ throw
                }

                const imgArrayForHistory = await processedTensor.array(); // í…ì„œì—ì„œ ë‹¤ì‹œ ë°°ì—´ ì–»ê¸°
                const flatArrayForHistory = imgArrayForHistory[0].flat();
                const grayScalePixelsForHistory = new Uint8ClampedArray(28 * 28 * 4);

                for (let i = 0; i < 28 * 28; i++) {
                    const gray = Math.round((1 - flatArrayForHistory[i]) * 255);
                    grayScalePixelsForHistory[i * 4 + 0] = gray;
                    grayScalePixelsForHistory[i * 4 + 1] = gray;
                    grayScalePixelsForHistory[i * 4 + 2] = gray;
                    grayScalePixelsForHistory[i * 4 + 3] = 255; // ì™„ì „ ë¶ˆíˆ¬ëª…
                }

                const imgDataForHistory = new ImageData(grayScalePixelsForHistory, 28, 28);

                historyManager.addImage(imgDataForHistory, result.result, 'prediction');

                // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ (í™”ë©´ ìƒë‹¨ ë©”ì‹œì§€ ì‚¬ìš©)
                showSystemMessage(result.message || 'ì˜ˆì¸¡ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');

                predictedDigit = result.result;
                probabilities = result.probs;

            } catch (error) {
                console.error('ì˜ˆì¸¡ ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜:', error);
                // ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ (í™”ë©´ ìƒë‹¨ ë©”ì‹œì§€ ì‚¬ìš©)
                showSystemMessage(`ì˜ˆì¸¡ ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}. ì„œë²„ ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.`, 'error');

            } finally {
                // TensorFlow.js Tensor ë©”ëª¨ë¦¬ ì •ë¦¬
                if (processedTensor) processedTensor.dispose();

                if (typeof predictedDigit !== 'undefined' && Array.isArray(probabilities) && probabilities.length === 10) {
                    showPredictionResult(predictedDigit, probabilities);
                } else if (typeof predictedDigit !== 'undefined') {
                    // í™•ë¥ ê°’ì€ ì—†ì§€ë§Œ ì˜ˆì¸¡ ìˆ«ìëŠ” ë°›ì€ ê²½ìš° (ì„œë²„ ì˜¤ë¥˜ ë“±)
                    showPredictionResult(predictedDigit, new Array(10).fill(0)); // í™•ë¥ ê°’ì€ 0ìœ¼ë¡œ ì±„ì›Œ í‘œì‹œ
                } else {
                    // ì˜ˆì¸¡ ìˆ«ìë„ ë°›ì§€ ëª»í•œ ê²½ìš°
                    showPredictionResult('ì•Œ ìˆ˜ ì—†ìŒ', new Array(10).fill(0)); // ê¸°ë³¸ ê²°ê³¼ í‘œì‹œ
                }

                // ì˜ˆì¸¡ ë²„íŠ¼ ë‹¤ì‹œ í™œì„±í™” ë° í…ìŠ¤íŠ¸ ë³µì›
                const predictBtn = document.getElementById('predictBtn');
                if (predictBtn) {
                    predictBtn.disabled = false;
                    predictBtn.textContent = 'ğŸ” ì¸ì‹í•˜ê¸°';
                }
            }
        }

        // ì˜ˆì¸¡ ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜ (ìœ ì§€ - predictWithServer ì•„ë˜ë¡œ ì´ë™í•˜ì—¬ ê´€ë ¨ ë¡œì§ê³¼ ê°€ê¹ê²Œ ë°°ì¹˜)
        function showPredictionResult(predictedDigit, probabilities) {
            const resultsDiv = document.getElementById('results');
            const predictionResult = document.getElementById('predictionResult');
            if (predictionResult) { // null ì²´í¬ ì¶”ê°€
                predictionResult.innerHTML = `ì˜ˆì¸¡: <strong style="color: #667eea; font-size: 2rem;">${predictedDigit}</strong>`;
            }

            // ì‹ ë¢°ë„ ë§‰ëŒ€ ì—…ë°ì´íŠ¸
            for (let i = 0; i < 10; i++) {
                const fillElement = document.getElementById(`conf-${i}`);
                const textElement = document.getElementById(`conf-text-${i}`);
                if (fillElement && textElement) { // null ì²´í¬ ì¶”ê°€
                    const percentage = (probabilities[i] * 100).toFixed(1);
                    fillElement.style.height = `${probabilities[i] * 100}%`;
                    textElement.textContent = `${percentage}%`;
                    if (i === predictedDigit) {
                        fillElement.style.background = 'linear-gradient(to top, #ff6b6b, #ee5a24)';
                    } else {
                        fillElement.style.background = 'linear-gradient(to top, #667eea, #764ba2)';
                    }
                }
            }
            if (resultsDiv) {
                resultsDiv.style.display = 'block';
            }
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •

        window.addEventListener('load', async () => {

            await initServerStatusCheck();

            await historyManager.loadHistory();

            // ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸
            canvas.addEventListener('mousedown', (e) => {
                isDrawing = true;
                const pos = getTouchPos(e);
                ctx.beginPath();
                ctx.moveTo(pos.x, pos.y);
            });

            canvas.addEventListener('mousemove', (e) => {
                if (!isDrawing) return;
                const pos = getTouchPos(e);
                ctx.lineTo(pos.x, pos.y);
                ctx.stroke();
            });

            canvas.addEventListener('mouseup', () => {
                isDrawing = false;
            });

            canvas.addEventListener('mouseout', () => {
                isDrawing = false;
            });

            // í„°ì¹˜ ì´ë²¤íŠ¸
            canvas.addEventListener('touchstart', (e) => {
                e.preventDefault();
                isDrawing = true;
                const pos = getTouchPos(e);
                ctx.beginPath();
                ctx.moveTo(pos.x, pos.y);
            });

            canvas.addEventListener('touchmove', (e) => {
                e.preventDefault();
                if (!isDrawing) return;
                const pos = getTouchPos(e);
                ctx.lineTo(pos.x, pos.y);
                ctx.stroke();
            });

            canvas.addEventListener('touchend', (e) => {
                e.preventDefault();
                isDrawing = false;
            });

            canvas.addEventListener('touchcancel', (e) => {
                e.preventDefault();
                isDrawing = false;
            });

            // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && modelReady) {
                    // ì˜ˆì¸¡ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ íŠ¸ë¦¬ê±°
                    const predictBtn = document.getElementById('predictBtn');
                    if (predictBtn && !predictBtn.disabled) {
                        predictBtn.click();
                    }
                } else if (e.key === 'Escape' || e.key === 'Delete') {
                    // ESC ë˜ëŠ” Delete í‚¤ë¡œ ìº”ë²„ìŠ¤ë§Œ ì§€ìš°ê¸° (íˆìŠ¤í† ë¦¬ëŠ” ìœ ì§€)
                    clearCanvas();
                } else if (e.key === 'Backspace') {
                    // Backspace í‚¤ë¡œ íˆìŠ¤í† ë¦¬ê¹Œì§€ ëª¨ë‘ ì§€ìš°ê¸°
                    historyManager.clear();
                    clearCanvas(); // ìº”ë²„ìŠ¤ë„ í•¨ê»˜ ì§€ìš°ê¸°
                }
            });

            const clearBtn = document.getElementById('clearBtn');
            if (clearBtn) {
                clearBtn.addEventListener('click', clearCanvas);
            }

            const predictBtn = document.getElementById('predictBtn');
            if (predictBtn) {
                predictBtn.addEventListener('click', async () => {
                    // ì˜ˆì¸¡ ë¡œì§ ì‹¤í–‰
                    try {
                        predictBtn.disabled = true;
                        predictBtn.textContent = 'ì¸ì‹ ì¤‘...';

                        await predictWithServer();
                    } catch (error) {
                        console.error('ì˜ˆì¸¡ ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜:', error);
                        // ì˜¤ë¥˜ ë©”ì‹œì§€ëŠ” predictWithServer ë‚´ë¶€ì—ì„œ ì²˜ë¦¬
                    } finally {
                    }
                });
            }

            const sendFeedbackBtn = document.getElementById('sendFeedbackBtn');
            if (sendFeedbackBtn) {
                sendFeedbackBtn.addEventListener('click', async (event) => {
                    event.preventDefault();
                    event.stopPropagation();

                    const correctDigitSelect = document.getElementById('correctDigit');
                    const correctDigit = parseInt(correctDigitSelect.value);
                    if (correctDigit >= 0 && correctDigit <= 9) {
                        // ë²„íŠ¼ ìƒíƒœ ë³€ê²½ì€ sendFeedbackToServer ë‚´ë¶€ì—ì„œ ì²˜ë¦¬
                        try {
                            await sendFeedbackToServer(correctDigit);
                        } catch (error) {
                            console.error('í”¼ë“œë°± ì „ì†¡ ì¤‘ ì˜¤ë¥˜:', error);
                            // ì˜¤ë¥˜ ë©”ì‹œì§€ëŠ” sendFeedbackToServer ë‚´ë¶€ì—ì„œ ì²˜ë¦¬
                        }
                    } else {
                        showSystemMessage('ì •ë‹µ ìˆ«ìë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error'); // alert ëŒ€ì‹  í™”ë©´ ë©”ì‹œì§€ ì‚¬ìš©
                    }
                });
            }

            // íˆìŠ¤í† ë¦¬ ì´ˆê¸°í™” ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            const clearHistoryBtn = document.getElementById('clearHistoryBtn');
            if (clearHistoryBtn) {
                clearHistoryBtn.addEventListener('click', () => {
                    historyManager.clear();
                    // íˆìŠ¤í† ë¦¬ ì´ˆê¸°í™” ì•Œë¦¼ ë©”ì‹œì§€ í‘œì‹œ
                    showSystemMessage('íˆìŠ¤í† ë¦¬ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                });
            }
        });

    </script>
</body>

</html>
